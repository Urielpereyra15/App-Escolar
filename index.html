<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inicio Escolar</title>
<style>
  body { margin:0; font-family: Arial, sans-serif; background-color:#334455; color:white; }
  nav { display:flex; justify-content:center; gap:10px; padding:10px; background-color:#0b2c56; position:sticky; top:0; }
  nav a { text-decoration:none; color:white; background-color:#0d4a8c; padding:10px 15px; border-radius:10px; font-size:14px; display:inline-block; }
  nav a:hover { background-color:#1565c0; }
  .container { padding:15px; display:flex; flex-direction:column; gap:15px; }
  .card { background:#0d3d77; border-radius:15px; padding:15px; }
  .card h3 { margin:0 0 10px; display:flex; align-items:center; gap:8px; font-size:18px; }
  .grade { display:flex; align-items:center; gap:5px; background:#1657a2; padding:10px; border-radius:10px; margin-bottom:8px; }
  .circle { width:28px; height:28px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold; color:white; }
  .green { background:green; }
  .yellow { background:orange; }
  .red { background:red; }
  span.materia { flex-grow:1; text-align:left; margin-left:2px; }
</style>
</head>
<body>

<nav>
  <a href="index.html">üè† Inicio</a>
  <a href="agenda.html">üìí Agenda</a>
  <a href="calificacion.html">‚≠ê Calificaci√≥n</a>
  <a href="asignaturas.html">üéì Asignaturas</a>
  <a href="malla-curricular.html">üìë Malla Curricular</a>
</nav>

<div class="container">

  <div class="card">
    <h3>‚≠ê √öltimas calificaciones <span id="promedio" style="margin-left:auto;">Promedio: 0,00</span></h3>
    <div id="ultimas-calificaciones"></div>
  </div>

</div>

<script>
// Funci√≥n para color de nota
function colorNota(nota,sistema,minAprobado){
  nota = nota.toString().trim(); minAprobado = parseFloat(minAprobado);
  if(sistema==="1-10"){ nota=parseFloat(nota); if(nota<minAprobado-2) return "red"; if(nota>=minAprobado-2 && nota<minAprobado) return "yellow"; return "green"; }
  if(sistema==="0-100"){ nota=parseFloat(nota); if(nota<minAprobado-10) return "red"; if(nota>=minAprobado-10 && nota<minAprobado) return "yellow"; return "green"; }
  if(sistema==="0-1") return nota==="0"?"red":"green";
  if(sistema==="si-no") return nota.toLowerCase()==="no"?"red":"green";
  return "";
}

// Cargar calificaciones desde localStorage
let calificaciones = JSON.parse(localStorage.getItem("calificaciones")||"[]");

// Ordenar por fecha descendente
calificaciones.sort((a,b)=> new Date(b.fecha) - new Date(a.fecha));

// Tomar √∫ltimas 5
let ultimas5 = calificaciones.slice(0,5);

const contenedor = document.getElementById("ultimas-calificaciones");
contenedor.innerHTML = '';

// Mostrar √∫ltimas 5 calificaciones
ultimas5.forEach(c=>{
  const div = document.createElement('div');
  div.classList.add('grade');

  const circle = document.createElement('div');
  circle.classList.add('circle', colorNota(c.nota,c.sistema,c.minAprobado));
  circle.textContent = c.nota;

  const nombre = document.createElement('span');
  nombre.classList.add('materia');
  nombre.textContent = c.materia;

  div.appendChild(circle);
  div.appendChild(nombre);

  contenedor.appendChild(div);
});

// Calcular promedio total
let sumaNotas = 0;
calificaciones.forEach(c=> sumaNotas += parseFloat(c.nota) || 0);
const promedioTotal = calificaciones.length ? (sumaNotas / calificaciones.length).toFixed(2) : '0,00';
document.getElementById("promedio").textContent = `Promedio: ${promedioTotal}`;
</script>

</body>
</html>
