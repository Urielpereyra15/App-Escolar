<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Agenda Escolar</title>
<style>
body {
    font-family: Arial, sans-serif;
    background-color: #334455;
    color: white;
    margin: 0;
    padding: 20px;
}
.container {
    max-width: 600px;
    margin: auto;
}
.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    background-color: #1657a2;
    border-radius: 15px;
    margin-bottom: 20px;
}
.header h1 {
    margin: 0;
    font-size: 1.5em;
}
.icon {
    font-size: 1.5em;
    cursor: pointer;
}
.calendar-section {
    background-color: #1a2b3c;
    padding: 20px;
    border-radius: 15px;
    text-align: center;
    margin-bottom: 20px;
}
.month-year-nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}
.month-box, .year-box {
    background-color: #004080;
    padding: 8px 15px;
    border-radius: 10px;
    color: white;
    font-weight: bold;
    text-align: center;
}
.days-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 10px;
}
.day-header {
    font-weight: bold;
    font-size: 0.9em;
}
.day {
    padding: 10px;
    border-radius: 5px;
    background-color: #1657a2;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}
.day.weekend {
    background-color: #15202b;
}
.day.current-day {
    background: transparent;
    border: 2px solid #0056b3;
    border-radius: 50%;
    color: white;
    padding: 8px;
}
.day.has-event::after {
    content: '';
    position: absolute;
    bottom: 3px;
    left: 50%;
    transform: translateX(-50%);
    width: 6px;
    height: 6px;
    background-color: #f0c300;
    border-radius: 50%;
}
.agenda-section {
    background-color: #1a2b3c;
    padding: 20px;
    border-radius: 15px;
}
.agenda-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}
.agenda-header h2 {
    margin: 0;
    font-size: 1.5em;
}
.agenda-item {
    background-color: #004080;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 10px;
    position: relative;
}
.delete-event {
    position:absolute;
    top:5px;
    right:10px;
    cursor:pointer;
    color:#f00;
    font-weight:bold;
}
.icon-plus {
    font-family: 'Arial', sans-serif;
    font-size: 24px;
    cursor: pointer;
}
/* Modal */
#eventModal {
    display:none; 
    position:fixed; 
    top:0; left:0; 
    width:100%; height:100%; 
    background:rgba(0,0,0,0.7); 
    justify-content:center; 
    align-items:center;
}
#eventModal div {
    background:#1a2b3c; 
    padding:20px; 
    border-radius:15px; 
    width:90%; 
    max-width:400px; 
    color:white;
}
#eventModal input {
    width:100%; 
    padding:8px; 
    margin:5px 0; 
    border-radius:5px; 
    border:none;
}
#eventModal button {
    padding:10px 20px; 
    border:none; 
    border-radius:10px; 
    cursor:pointer; 
    margin:5px;
}
#saveEventBtn { background:#1657a2; color:white; }
#closeModalBtn { background:#555; color:white; }
</style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>ðŸ“’ Agenda</h1>
        <span class="icon icon-plus" id="plusBtn">+</span>
    </div>

    <div class="calendar-section">
        <div class="month-year-nav">
            <button id="prevBtn">&lt;</button>
            <div class="month-box" id="monthDisplay"></div>
            <div class="year-box" id="yearDisplay"></div>
            <button id="nextBtn">&gt;</button>
        </div>
        <div class="days-grid" id="daysGrid"></div>
    </div>

    <div class="agenda-section">
        <div class="agenda-header">
            <h2>PrÃ³ximos eventos</h2>
        </div>
        <div id="eventsList"></div>
    </div>
</div>

<!-- Modal para agregar eventos -->
<div id="eventModal">
    <div>
        <h3 style="text-align:center;">Agregar Evento</h3>
        <label>Fecha y hora:</label>
        <input type="datetime-local" id="eventDateTime">
        <label>Materia:</label>
        <input type="text" id="eventSubject" placeholder="Ej: MatemÃ¡tica">
        <label>Link de Zoom:</label>
        <input type="text" id="eventLink" placeholder="https://...">
        <div style="text-align:center; margin-top:10px;">
            <button id="saveEventBtn">Guardar</button>
            <button id="closeModalBtn">Cancelar</button>
        </div>
    </div>
</div>

<script>
const months = ["ENERO","FEBRERO","MARZO","ABRIL","MAYO","JUNIO","JULIO","AGOSTO","SEPTIEMBRE","OCTUBRE","NOVIEMBRE","DICIEMBRE"];
const weekDays = ["LU","MA","MI","JU","VI","SA","DO"];

const monthDisplay = document.getElementById('monthDisplay');
const yearDisplay = document.getElementById('yearDisplay');
const daysGrid = document.getElementById('daysGrid');
const eventsList = document.getElementById('eventsList');

const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const plusBtn = document.getElementById('plusBtn');
const modal = document.getElementById('eventModal');
const closeModalBtn = document.getElementById('closeModalBtn');
const saveEventBtn = document.getElementById('saveEventBtn');
const eventDateTime = document.getElementById('eventDateTime');
const eventSubject = document.getElementById('eventSubject');
const eventLink = document.getElementById('eventLink');

let currentDate = new Date();
let events = JSON.parse(localStorage.getItem('schoolEvents')) || [];

function renderCalendar() {
    const year = currentDate.getFullYear();
    const month = currentDate.getMonth();
    monthDisplay.textContent = months[month];
    yearDisplay.textContent = year;
    daysGrid.innerHTML = '';

    weekDays.forEach(day => {
        const headerEl = document.createElement('div');
        headerEl.classList.add('day-header');
        headerEl.textContent = day;
        daysGrid.appendChild(headerEl);
    });

    const firstDayOfMonth = new Date(year, month, 1).getDay();
    const lastDayOfMonth = new Date(year, month +1 ,0).getDate();
    const firstDayIndex = (firstDayOfMonth + 6) % 7;

    for(let i=0; i<firstDayIndex; i++) daysGrid.appendChild(document.createElement('div'));

    for(let day=1; day<=lastDayOfMonth; day++){
        const dayEl = document.createElement('div');
        dayEl.classList.add('day');
        dayEl.textContent = day;

        const dayOfWeek = (firstDayIndex + day -1)%7;
        if(dayOfWeek >=5) dayEl.classList.add('weekend');

        const today = new Date();
        if(day===today.getDate() && month===today.getMonth() && year===today.getFullYear()) dayEl.classList.add('current-day');

        const dayEvents = events.filter(e=>e.date && new Date(e.date).getDate()===day && new Date(e.date).getMonth()===month && new Date(e.date).getFullYear()===year);
        if(dayEvents.length>0) dayEl.classList.add('has-event');

        daysGrid.appendChild(dayEl);
    }

    renderEvents();
}

function renderEvents(){
    eventsList.innerHTML='';
    const today = new Date();
    const tomorrow = new Date(today);
    tomorrow.setDate(today.getDate()+1);

    const sortedEvents = events.sort((a,b)=> new Date(a.date)-new Date(b.date));
    if(sortedEvents.length===0){
        const item = document.createElement('div');
        item.classList.add('agenda-item');
        item.textContent='No hay eventos para este mes.';
        eventsList.appendChild(item);
        return;
    }

    sortedEvents.forEach(event=>{
        const item = document.createElement('div');
        item.classList.add('agenda-item');
        const eventDate = new Date(event.date);
        let dateLabel='';
        if(eventDate.toDateString()===today.toDateString()) dateLabel='Hoy';
        else if(eventDate.toDateString()===tomorrow.toDateString()) dateLabel='MaÃ±ana';
        else dateLabel=`${eventDate.getDate()} de ${months[eventDate.getMonth()]}`;

        item.innerHTML=`<div>${dateLabel} - ${event.subject} - <a href="${event.zoomLink}" target="_blank" style="color:#f0c300;">Zoom</a></div>
                        <span class="delete-event">Ã—</span>`;

        item.querySelector('.delete-event').addEventListener('click',()=>{
            const index = events.findIndex(e=>e.date===event.date && e.subject===event.subject);
            if(index>-1){ events.splice(index,1); localStorage.setItem('schoolEvents', JSON.stringify(events)); renderCalendar();}
        });

        eventsList.appendChild(item);
    });
}

prevBtn.addEventListener('click',()=>{ currentDate.setMonth(currentDate.getMonth()-1); renderCalendar(); });
nextBtn.addEventListener('click',()=>{ currentDate.setMonth(currentDate.getMonth()+1); renderCalendar(); });

plusBtn.addEventListener('click',()=>{ modal.style.display='flex'; });
closeModalBtn.addEventListener('click',()=>{
    modal.style.display='none';
    eventDateTime.value=''; eventSubject.value=''; eventLink.value='';
});

saveEventBtn.addEventListener('click',()=>{
    const datetime = eventDateTime.value;
    const subject = eventSubject.value.trim();
    const link = eventLink.value.trim();

    if(!datetime || !subject || !link){ alert('Completa todos los campos'); return; }

    events.push({ date: datetime, subject: subject, zoomLink: link });
    localStorage.setItem('schoolEvents', JSON.stringify(events));

    modal.style.display='none';
    eventDateTime.value=''; eventSubject.value=''; eventLink.value='';

    renderCalendar();
});

renderCalendar();
</script>

</body>
</html>
